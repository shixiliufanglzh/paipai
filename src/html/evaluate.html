<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <script>
        (function (doc, win) {
            var docEl = doc.documentElement,
                    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function () {
                        var clientWidth = docEl.clientWidth;
                        if (!clientWidth) return;
                        if(clientWidth>=640){
                            docEl.style.fontSize = '100px';
                        }else{
                            docEl.style.fontSize = 100 * (clientWidth / 750) + 'px';
                        }
                    };

            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);
    </script>
    <link rel="stylesheet" href="../style/service.css">
</head>
<body>
<div id="serviceDetail">

    <div id="grade">
        <span class="title">总体评价</span>
        <span class="chose_grade"><i></i><i></i><i></i><i></i><i></i></span>
        <span class="state">待评价</span>
    </div>

    <div id="addition">
        <!--<h3>补充说明：</h3>-->
        <textarea placeholder="评价内容"></textarea>
    </div>

    <div id="uploadPics" class="pic_evaluate clearfix">
        <h3>上传凭证<span>（最多上传4张照片）</span>：</h3>
        <input type="file" id="uploadImg" accept="image/*" multiple="multiple" capture=“camera”>
        <div id="pics_box">
            <!--<span class="picture"><i></i></span>-->
        </div>
        <label for="uploadImg" class="add_pic"></label>
    </div>


    <button id="msgSubmit" class="submit_eva">提交</button>
</div>



</body>
<!--<script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>-->
<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../script/exif.js"></script>
<script src="../script/paipaiCompnt.js"></script>

<script>

    $(function(){

    })

    var imgListBase64 = [];
//    var imgListUrl = [];
    $('#uploadImg').change(function(e){
        commonCompt.readFile(e.target,imgListBase64,$('#pics_box'),$('label.add_pic'));
    })

    $('#pics_box').on('click', '.picture i',function(){
//        console.log("删除前：",imgListBase64);
//        console.log($(this).parent().index());
        imgListBase64.splice($(this).parent().index(),1);
//        imgListUrl.splice($(this).parent().index(),1);
//        console.log("删除后：",imgListBase64);
        $(this).parent().remove();
        imgListBase64,$('#pics_box').html('');
        for(var i=0;i<imgListBase64.length;i++){
            $('#pics_box').append('<span class="picture" style="background: url('+ imgListBase64[i] +') center center no-repeat;-webkit-background-size: cover;background-size: cover"><i></i></span>');
        }
        if(imgListBase64.length < 4) {
            $('label.add_pic').show();
        }
    })

    $('#msgSubmit').click(function(){
//        console.log("待提交：",imgListBase64);
        var $reason = $('.reason_sel').val();
        if(!$reason){
            commonCompt.popPrompt("请选择退款原因");
        }else {
//            $.ajax({
//                url:'http://yiyayiya.0lz.net/verify_phone',
//                data: {
//
//                },
//                type:'post',
//                dataType:'json',
////                async:false,
//                success:function(data){},
//                error: function(err){}
//            })
        }

        var data = {
            reason: "不想要了",
            imgs: imgListBase64,
            addition: "这个商品的发生的故事公司如果发"
        }

        console.log(data);
    })

    $('.chose_grade').on('click','i',function(){
        var grade = $(this).index();
//        console.log(grade);
        $('.chose_grade i').removeClass('light');
        for(var i=0; i<grade+1; i++){
            $('.chose_grade i').eq(i).addClass('light');
        }
        var eva_summary = "";
        switch(grade){
            case 0 :
                eva_summary = "非常差";
                break;
            case 1 :
                eva_summary = "差";
                break;
            case 2 :
                eva_summary = "一般";
                break;
            case 3 :
                eva_summary = "好";
                break;
            case 4 :
                eva_summary = "非常好";
                break;
            default:
                eva_summary = "待评价";
        };
//        console.log(eva_summary);
        $('#grade .state').html(eva_summary);
    })




</script>
</html>